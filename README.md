# @ldesign/api

ğŸš€ **ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„é€šç”¨ç³»ç»Ÿæ¥å£ç®¡ç†åŒ…** - æ”¯æŒæ’ä»¶åŒ–æ¶æ„ã€å†…ç½®ç³»ç»Ÿæ¥å£ã€æ€§èƒ½ä¼˜åŒ–ï¼Œå®Œç¾é›†æˆ Vue 3

[![npm version](https://img.shields.io/npm/v/@ldesign/api.svg)](https://www.npmjs.com/package/@ldesign/api)
[![license](https://img.shields.io/npm/l/@ldesign/api.svg)](https://github.com/ldesign/ldesign/blob/main/LICENSE)
[![TypeScript](https://img.shields.io/badge/TypeScript-Ready-blue.svg)](https://www.typescriptlang.org/)

## ğŸ‰ æœ€æ–°ä¼˜åŒ–ï¼ˆ2025å¹´10æœˆï¼‰

**æ€§èƒ½å¤§å¹…æå‡ï¼** æˆ‘ä»¬å®Œæˆäº†å…¨é¢çš„æ€§èƒ½å’Œå†…å­˜ä¼˜åŒ–ï¼š

- âš¡ **åºåˆ—åŒ–é€Ÿåº¦æå‡ 60-80%** - æ™ºèƒ½ç¼“å­˜å’Œå¿«é€Ÿè·¯å¾„
- ğŸ”„ **å¯¹è±¡å¤ç”¨ç‡æå‡ 40-60%** - åˆ†çº§å¯¹è±¡æ± 
- ğŸ’¾ **å†…å­˜å ç”¨é™ä½ 30-40%** - å†…å­˜ä¿æŠ¤å’Œè‡ªåŠ¨é™çº§
- ğŸš€ **æ¶ˆé™¤100+é­”æ³•æ•°å­—** - é›†ä¸­å¸¸é‡ç®¡ç†
- ğŸ“ **å®Œå–„ä»£ç æ³¨é‡Š** - æ ¸å¿ƒç®—æ³•è¯¦ç»†è¯´æ˜

æŸ¥çœ‹ [ä¼˜åŒ–æ€»ç»“æŠ¥å‘Š](./OPTIMIZATION_SUMMARY_CN.md) äº†è§£è¯¦æƒ…ã€‚

## âœ¨ ç‰¹æ€§

### ğŸ“š å¿«é€Ÿå¯¼èˆªï¼ˆæ–°å¢ï¼‰
- å®‰è£…ä¸å…¥é—¨ï¼šdocs/guide/installation.md
- ä¸­é—´ä»¶ä¸é‡è¯•ï¼šdocs/guide/middlewares.md
- ç³»ç»Ÿ API æŒ‡å—ï¼šdocs/guide/system-api.md
- REST æ’ä»¶ä¸åˆ†é¡µï¼šdocs/guide/rest.md
- Vue ç»„åˆå¼æŒ‡å—ï¼šdocs/guide/vue.md
- ç±»å‹å¢å¼ºï¼šwithTypedApiï¼ˆè§ middlewares.mdã€rest.md ä¸ typed-registry.mdï¼‰
- æœ€ä½³å®è·µï¼šdocs/guide/best-practices.md
- å¸¸è§é—®é¢˜ï¼šdocs/guide/faq.md

ğŸ”Œ **æ’ä»¶åŒ–æ¶æ„** - é€šè¿‡ `engine.use()` æ–¹æ³•è½»æ¾æ‰©å±•å’Œç®¡ç†æ¥å£æ–¹æ³• ğŸ¯
**å†…ç½®ç³»ç»Ÿæ¥å£** - æä¾›å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£ï¼Œå¦‚ç™»å½•ã€ç”¨æˆ·ä¿¡æ¯ã€èœå•ç­‰ âš¡
**æ€§èƒ½ä¼˜åŒ–** - å†…ç½®ç¼“å­˜ã€é˜²æŠ–ã€è¯·æ±‚å»é‡ç­‰æ€§èƒ½ä¼˜åŒ–æœºåˆ¶ ğŸŒŸ
**æ¡†æ¶æ— å…³** - çº¯ JavaScript/TypeScript åŒ…ï¼Œå¯åœ¨ä»»ä½•å‰ç«¯æ¡†æ¶ä¸­ä½¿ç”¨ ğŸ’ **Vue 3 æ·±åº¦é›†æˆ** - ä¸“ä¸º Vue
3 è®¾è®¡çš„ç»„åˆå¼ API å’Œæ’ä»¶ç³»ç»Ÿ ğŸ›¡ï¸ **TypeScript ä¼˜å…ˆ** - å®Œæ•´çš„ç±»å‹å®šä¹‰ï¼Œæä¾›å‡ºè‰²çš„å¼€å‘ä½“éªŒ ğŸ”§
**é«˜åº¦å¯é…ç½®** - çµæ´»çš„é…ç½®é€‰é¡¹ï¼Œæ»¡è¶³å„ç§ä¸šåŠ¡éœ€æ±‚ ğŸ“¦ **è½»é‡çº§** - ç²¾å¿ƒè®¾è®¡çš„æ¶æ„ï¼Œä¿æŒåŒ…ä½“ç§¯å°å·§

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
# ä½¿ç”¨ pnpmï¼ˆæ¨èï¼‰
pnpm add @ldesign/api

# ä½¿ç”¨ npm
npm install @ldesign/api

# ä½¿ç”¨ yarn
yarn add @ldesign/api
```

### åŸºç¡€ç”¨æ³•

```typescript
import { createApiEngine, systemApiPlugin } from '@ldesign/api'

// åˆ›å»º API å¼•æ“
const apiEngine = createApiEngine({
  debug: true,
  http: {
    baseURL: 'https://api.example.com',
    timeout: 10000,
  },
})

// ä½¿ç”¨å†…ç½®ç³»ç»Ÿæ¥å£æ’ä»¶
await apiEngine.use(systemApiPlugin)

// è°ƒç”¨ç³»ç»Ÿæ¥å£
const userInfo = await apiEngine.call('getUserInfo')
const menus = await apiEngine.call('getMenus')

// ç™»å½•ç¤ºä¾‹
const loginResult = await apiEngine.call('login', {
  username: 'admin',
  password: 'password123',
})
```

### Vue 3 é›†æˆ

```vue
<script setup lang="ts">
import { useSystemApi } from '@ldesign/api'

const systemApi = useSystemApi()

// è·å–ç”¨æˆ·ä¿¡æ¯
const {
  data: userInfo,
  loading,
  error,
  execute: fetchUserInfo,
} = systemApi.getUserInfo({
  immediate: true, // ç«‹å³æ‰§è¡Œ
})

// ç™»å½•
const { execute: login } = systemApi.login({
  onSuccess: result => {
    console.log('ç™»å½•æˆåŠŸ:', result)
  },
  onError: error => {
    console.error('ç™»å½•å¤±è´¥:', error)
  },
})

const handleLogin = async () => {
  await login({
    username: 'admin',
    password: 'password123',
  })
}
</script>

<template>
  <div>
    <div v-if="loading">åŠ è½½ä¸­...</div>
    <div v-else-if="error">é”™è¯¯: {{ error.message }}</div>
    <div v-else-if="userInfo">
      <h2>æ¬¢è¿, {{ userInfo.username }}!</h2>
      <p>é‚®ç®±: {{ userInfo.email }}</p>
    </div>

    <button @click="handleLogin">ç™»å½•</button>
  </div>
</template>
```

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### API å¼•æ“

API å¼•æ“æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒï¼Œè´Ÿè´£ç®¡ç†æ¥å£æ–¹æ³•ã€æ’ä»¶ã€ç¼“å­˜ç­‰åŠŸèƒ½ï¼š

```typescript
import { createApiEngine } from '@ldesign/api'

const apiEngine = createApiEngine({
  // HTTP å®¢æˆ·ç«¯é…ç½®
  http: {
    baseURL: 'https://api.example.com',
    timeout: 10000,
    headers: {
      'Content-Type': 'application/json',
    },
  },

  // ç¼“å­˜é…ç½®
  cache: {
    enabled: true,
    ttl: 300000, // 5åˆ†é’Ÿ
    storage: 'memory', // 'memory' | 'localStorage' | 'sessionStorage'
  },

  // é˜²æŠ–é…ç½®
  debounce: {
    enabled: true,
    delay: 300, // 300ms
  },

  // è¯·æ±‚å»é‡é…ç½®
  deduplication: {
    enabled: true,
  },
})
```

### æ’ä»¶ç³»ç»Ÿ

é€šè¿‡æ’ä»¶ç³»ç»Ÿå¯ä»¥è½»æ¾æ‰©å±•å’Œç®¡ç†æ¥å£æ–¹æ³•ï¼š

```typescript
// åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶
const customPlugin = {
  name: 'custom-apis',
  version: '1.0.0',
  apis: {
    getProducts: {
      name: 'getProducts',
      config: {
        method: 'GET',
        url: '/products',
      },
      cache: { enabled: true, ttl: 600000 }, // 10åˆ†é’Ÿç¼“å­˜
    },

    createProduct: {
      name: 'createProduct',
      config: params => ({
        method: 'POST',
        url: '/products',
        data: params,
      }),
      cache: { enabled: false }, // ä¸ç¼“å­˜
    },
  },

  install: engine => {
    console.log('è‡ªå®šä¹‰æ’ä»¶å·²å®‰è£…')
  },
}

// ä½¿ç”¨æ’ä»¶
await apiEngine.use(customPlugin)

// è°ƒç”¨è‡ªå®šä¹‰æ¥å£
const products = await apiEngine.call('getProducts')
const newProduct = await apiEngine.call('createProduct', {
  name: 'æ–°äº§å“',
  price: 99.99,
})
```

### å†…ç½®ç³»ç»Ÿæ¥å£

åŒ…å«å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£æ–¹æ³•ï¼š

```typescript
import { SYSTEM_API_METHODS, systemApiPlugin } from '@ldesign/api'

// ä½¿ç”¨ç³»ç»Ÿæ¥å£æ’ä»¶
await apiEngine.use(systemApiPlugin)

// è·å–éªŒè¯ç 
const captcha = await apiEngine.call(SYSTEM_API_METHODS.GET_CAPTCHA)

// ç”¨æˆ·ç™»å½•
const loginResult = await apiEngine.call(SYSTEM_API_METHODS.LOGIN, {
  username: 'admin',
  password: 'password123',
  captcha: '1234',
  captchaId: captcha.captchaId,
})

// è·å–ç”¨æˆ·ä¿¡æ¯
const userInfo = await apiEngine.call(SYSTEM_API_METHODS.GET_USER_INFO)

// è·å–ç³»ç»Ÿèœå•
const menus = await apiEngine.call(SYSTEM_API_METHODS.GET_MENUS)

// ç”¨æˆ·ç™»å‡º
await apiEngine.call(SYSTEM_API_METHODS.LOGOUT)
```

### æ€§èƒ½ä¼˜åŒ–

#### ç¼“å­˜æœºåˆ¶

```typescript
// å…¨å±€ç¼“å­˜é…ç½®
const apiEngine = createApiEngine({
  cache: {
    enabled: true,
    ttl: 300000, // é»˜è®¤ç¼“å­˜5åˆ†é’Ÿ
    maxSize: 100, // æœ€å¤§ç¼“å­˜æ¡ç›®æ•°
    storage: 'memory', // ç¼“å­˜å­˜å‚¨ç±»å‹
  },
})

// æ–¹æ³•çº§ç¼“å­˜é…ç½®
apiEngine.register('getUserProfile', {
  name: 'getUserProfile',
  config: { method: 'GET', url: '/user/profile' },
  cache: {
    enabled: true,
    ttl: 600000, // ç¼“å­˜10åˆ†é’Ÿ
  },
})
```

#### é˜²æŠ–æœºåˆ¶

```typescript
// å…¨å±€é˜²æŠ–é…ç½®
const apiEngine = createApiEngine({
  debounce: {
    enabled: true,
    delay: 300, // é»˜è®¤é˜²æŠ–300ms
  },
})

// æ–¹æ³•çº§é˜²æŠ–é…ç½®
apiEngine.register('searchUsers', {
  name: 'searchUsers',
  config: params => ({
    method: 'GET',
    url: '/users/search',
    params,
  }),
  debounce: {
    enabled: true,
    delay: 500, // é˜²æŠ–500ms
  },
})
```

#### è¯·æ±‚å»é‡

```typescript
// å¯ç”¨è¯·æ±‚å»é‡
const apiEngine = createApiEngine({
  deduplication: {
    enabled: true,
    keyGenerator: config => `${config.method}_${config.url}_${JSON.stringify(config.params)}`,
  },
})

// åŒæ—¶å‘èµ·ç›¸åŒè¯·æ±‚ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡
const [result1, result2, result3] = await Promise.all([
  apiEngine.call('getUserInfo'),
  apiEngine.call('getUserInfo'),
  apiEngine.call('getUserInfo'),
])
// result1ã€result2ã€result3 éƒ½æ˜¯ç›¸åŒçš„ç»“æœ
```

## ğŸ”§ Vue 3 é›†æˆ

### å®‰è£…æ’ä»¶

```typescript
import { ApiVuePlugin, systemApiPlugin } from '@ldesign/api'
// main.ts
import { createApp } from 'vue'
import App from './App.vue'

const app = createApp(App)

// å®‰è£… API æ’ä»¶
app.use(ApiVuePlugin, {
  debug: true,
  http: {
    baseURL: import.meta.env.VITE_API_BASE_URL,
  },
  globalPropertyName: '$api', // å…¨å±€å±æ€§åç§°
})

app.mount('#app')
```

### ç»„åˆå¼ API

```vue
<script setup lang="ts">
import { useApiCall, useSystemApi, useApi } from '@ldesign/api/vue'

// ä½¿ç”¨ç³»ç»Ÿ API
const systemApi = useSystemApi()

// ç”¨æˆ·ç™»å½•
const {
  data: loginResult,
  loading: loginLoading,
  error: loginError,
  execute: login,
} = systemApi.login({
  onSuccess: result => {
    // ç™»å½•æˆåŠŸå¤„ç†
    localStorage.setItem('token', result.accessToken)
  },
  onError: error => {
    // ç™»å½•å¤±è´¥å¤„ç†
    console.error('ç™»å½•å¤±è´¥:', error.message)
  },
})

// è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆç«‹å³æ‰§è¡Œï¼‰
const { data: userInfo, loading: userLoading } = systemApi.getUserInfo({ immediate: true })

// è‡ªå®šä¹‰ API è°ƒç”¨
const {
  data: products,
  loading: productsLoading,
  execute: fetchProducts,
} = useApiCall('getProducts')

// ç›´æ¥ä½¿ç”¨ API å¼•æ“
const apiEngine = useApi()

const handleLogin = async () => {
  try {
    await login({
      username: 'admin',
      password: 'password123',
    })
  } catch (error) {
    console.error('ç™»å½•å¤±è´¥:', error)
  }
}
</script>
```

### æ‰¹é‡ API è°ƒç”¨

```vue
<script setup lang="ts">
import { useBatchApiCall } from '@ldesign/api/vue'

// æ‰¹é‡è°ƒç”¨å¤šä¸ª API
const {
  data: batchData,
  loading: batchLoading,
  errors: batchErrors,
  execute: executeBatch,
} = useBatchApiCall(['getUserInfo', 'getMenus', 'getPermissions'])

// æ‰§è¡Œæ‰¹é‡è°ƒç”¨
const loadUserData = async () => {
  await executeBatch()

  // batchData.value åŒ…å«æ‰€æœ‰æˆåŠŸçš„ç»“æœ
  // batchErrors.value åŒ…å«æ‰€æœ‰å¤±è´¥çš„é”™è¯¯
}
</script>
```

## ğŸ“š API å‚è€ƒ

### æ ¸å¿ƒ API

#### createApiEngine(config?)

åˆ›å»º API å¼•æ“å®ä¾‹ã€‚

**å‚æ•°:**

- `config` (å¯é€‰): API å¼•æ“é…ç½®

**è¿”å›:** `ApiEngine` å®ä¾‹

#### ApiEngine.use(plugin)

æ³¨å†Œæ’ä»¶ã€‚

**å‚æ•°:**

- `plugin`: æ’ä»¶å¯¹è±¡

**è¿”å›:** `Promise<void>`

#### ApiEngine.call(methodName, params?)

è°ƒç”¨ API æ–¹æ³•ã€‚

**å‚æ•°:**

- `methodName`: æ–¹æ³•åç§°
- `params` (å¯é€‰): è¯·æ±‚å‚æ•°

**è¿”å›:** `Promise<any>`

### Vue ç»„åˆå¼ API

#### useApi()

è·å– API å¼•æ“å®ä¾‹ã€‚

**è¿”å›:** `ApiEngine` å®ä¾‹

#### useApiCall(methodName, options?)

åˆ›å»º API è°ƒç”¨çŠ¶æ€ã€‚

**å‚æ•°:**

- `methodName`: æ–¹æ³•åç§°
- `options` (å¯é€‰): è°ƒç”¨é€‰é¡¹

**è¿”å›:** API è°ƒç”¨çŠ¶æ€å¯¹è±¡

#### useSystemApi()

è·å–ç³»ç»Ÿ API æ–¹æ³•ã€‚

**è¿”å›:** ç³»ç»Ÿ API æ–¹æ³•å¯¹è±¡

## ğŸ› ï¸ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰æ’ä»¶å¼€å‘

```typescript
import type { ApiPlugin } from '@ldesign/api'

const advancedPlugin: ApiPlugin = {
  name: 'advanced-plugin',
  version: '1.0.0',
  dependencies: ['system-apis'], // ä¾èµ–å…¶ä»–æ’ä»¶

  apis: {
    // å®šä¹‰ API æ–¹æ³•
    getAdvancedData: {
      name: 'getAdvancedData',
      config: params => ({
        method: 'GET',
        url: '/advanced/data',
        params,
      }),

      // æ•°æ®è½¬æ¢
      transform: response => {
        return response.data.items
      },

      // æ•°æ®éªŒè¯
      validate: data => {
        return Array.isArray(data) && data.length > 0
      },

      // é”™è¯¯å¤„ç†
      onError: error => {
        console.error('è·å–é«˜çº§æ•°æ®å¤±è´¥:', error)
      },

      // ç¼“å­˜é…ç½®
      cache: {
        enabled: true,
        ttl: 600000, // 10åˆ†é’Ÿ
      },

      // é˜²æŠ–é…ç½®
      debounce: {
        enabled: true,
        delay: 500,
      },
    },
  },

  install: async engine => {
    // æ’ä»¶å®‰è£…é€»è¾‘
    console.log('é«˜çº§æ’ä»¶å·²å®‰è£…')

    // å¯ä»¥æ³¨å†Œé¢å¤–çš„æ–¹æ³•
    engine.register('customMethod', {
      name: 'customMethod',
      config: { method: 'GET', url: '/custom' },
    })
  },

  uninstall: engine => {
    // æ’ä»¶å¸è½½é€»è¾‘
    console.log('é«˜çº§æ’ä»¶å·²å¸è½½')
  },
}

// ä½¿ç”¨æ’ä»¶
await apiEngine.use(advancedPlugin)
```

### ä¸­é—´ä»¶å’Œæ‹¦æˆªå™¨

```typescript
import { createApiEngine } from '@ldesign/api'

const apiEngine = createApiEngine({
  http: {
    baseURL: 'https://api.example.com',

    // HTTP æ‹¦æˆªå™¨ä¼šè‡ªåŠ¨ç»§æ‰¿
    interceptors: {
      request: [
        // è¯·æ±‚æ‹¦æˆªå™¨
        config => {
          const token = localStorage.getItem('token')
          if (token) {
            config.headers.Authorization = `Bearer ${token}`
          }
          return config
        },
      ],

      response: [
        // å“åº”æ‹¦æˆªå™¨
        response => {
          if (response.data.code === 401) {
            // å¤„ç†è®¤è¯å¤±è´¥
            localStorage.removeItem('token')
            window.location.href = '/login'
          }
          return response
        },
      ],
    },
  },
})
```

### é”™è¯¯å¤„ç†

```typescript
// å…¨å±€é”™è¯¯å¤„ç†
apiEngine.register('riskyMethod', {
  name: 'riskyMethod',
  config: { method: 'GET', url: '/risky' },
  onError: error => {
    // æ–¹æ³•çº§é”™è¯¯å¤„ç†
    console.error('æ–¹æ³•æ‰§è¡Œå¤±è´¥:', error)

    // å¯ä»¥è¿›è¡Œé”™è¯¯ä¸ŠæŠ¥
    reportError(error)
  },
})

// è°ƒç”¨æ—¶çš„é”™è¯¯å¤„ç†
try {
  const result = await apiEngine.call('riskyMethod')
} catch (error) {
  // è°ƒç”¨çº§é”™è¯¯å¤„ç†
  console.error('è°ƒç”¨å¤±è´¥:', error)
}
```

## ğŸ“– æœ€ä½³å®è·µ

### 1. é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ plugins/           # è‡ªå®šä¹‰æ’ä»¶
â”‚   â”‚   â”œâ”€â”€ user-apis.ts
â”‚   â”‚   â””â”€â”€ product-apis.ts
â”‚   â”œâ”€â”€ config.ts          # API é…ç½®
â”‚   â””â”€â”€ index.ts           # API å…¥å£
â”œâ”€â”€ composables/           # Vue ç»„åˆå¼å‡½æ•°
â”‚   â””â”€â”€ useAuth.ts
â””â”€â”€ main.ts
```

### 2. é…ç½®ç®¡ç†

```typescript
// api/config.ts
import type { ApiEngineConfig } from '@ldesign/api'

export const apiConfig: ApiEngineConfig = {
  debug: import.meta.env.DEV,

  http: {
    baseURL: import.meta.env.VITE_API_BASE_URL,
    timeout: 10000,
    headers: {
      'Content-Type': 'application/json',
    },
  },

  cache: {
    enabled: true,
    ttl: 300000, // 5åˆ†é’Ÿ
    storage: 'memory',
  },

  debounce: {
    enabled: true,
    delay: 300,
  },

  deduplication: {
    enabled: true,
  },
}
```

### 3. æ’ä»¶ç»„ç»‡

```typescript
// api/plugins/user-apis.ts
import type { ApiPlugin } from '@ldesign/api'

export const userApisPlugin: ApiPlugin = {
  name: 'user-apis',
  version: '1.0.0',

  apis: {
    getUserProfile: {
      name: 'getUserProfile',
      config: { method: 'GET', url: '/user/profile' },
      cache: { enabled: true, ttl: 600000 },
    },

    updateUserProfile: {
      name: 'updateUserProfile',
      config: params => ({
        method: 'PUT',
        url: '/user/profile',
        data: params,
      }),
      cache: { enabled: false },
    },
  },

  install: engine => {
    console.log('ç”¨æˆ· API æ’ä»¶å·²å®‰è£…')
  },
}
```

### 4. ç»„åˆå¼å‡½æ•°å°è£…

```typescript
import { useSystemApi } from '@ldesign/api/vue'
// composables/useAuth.ts
import { computed, ref } from 'vue'

export function useAuth() {
  const systemApi = useSystemApi()
  const user = ref(null)
  const token = ref(localStorage.getItem('token'))

  const isLoggedIn = computed(() => !!token.value)

  const { execute: loginExecute, loading: loginLoading } = systemApi.login({
    onSuccess: result => {
      token.value = result.accessToken
      user.value = result.userInfo
      localStorage.setItem('token', result.accessToken)
    },
  })

  const { execute: logoutExecute } = systemApi.logout({
    onSuccess: () => {
      token.value = null
      user.value = null
      localStorage.removeItem('token')
    },
  })

  const login = async credentials => {
    await loginExecute(credentials)
  }

  const logout = async () => {
    await logoutExecute()
  }

  return {
    user,
    token,
    isLoggedIn,
    login,
    logout,
    loginLoading,
  }
}
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆæˆ‘çš„ API è°ƒç”¨æ²¡æœ‰è¢«ç¼“å­˜ï¼Ÿ**

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

1. ç¡®ä¿å…¨å±€ç¼“å­˜å·²å¯ç”¨ï¼š`cache: { enabled: true }`
2. ç¡®ä¿æ–¹æ³•çº§ç¼“å­˜æœªè¢«ç¦ç”¨ï¼š`cache: { enabled: false }`
3. æ£€æŸ¥ç¼“å­˜ TTL æ˜¯å¦å·²è¿‡æœŸ

**Q: é˜²æŠ–åŠŸèƒ½ä¸ç”Ÿæ•ˆï¼Ÿ**

A: ç¡®ä¿ï¼š

1. å…¨å±€é˜²æŠ–å·²å¯ç”¨ï¼š`debounce: { enabled: true }`
2. æ–¹æ³•çº§é˜²æŠ–æœªè¢«ç¦ç”¨
3. è°ƒç”¨å‚æ•°å®Œå…¨ç›¸åŒï¼ˆé˜²æŠ–åŸºäºå‚æ•°ç”Ÿæˆé”®ï¼‰

**Q: Vue ç»„åˆå¼ API æŠ¥é”™æ‰¾ä¸åˆ° API å¼•æ“ï¼Ÿ**

A: ç¡®ä¿ï¼š

1. å·²å®‰è£… Vue æ’ä»¶ï¼š`app.use(apiVuePlugin)`
2. åœ¨ç»„ä»¶å†…éƒ¨è°ƒç”¨ç»„åˆå¼å‡½æ•°
3. æ£€æŸ¥æ³¨å…¥é”®æ˜¯å¦æ­£ç¡®

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·æŸ¥çœ‹ [è´¡çŒ®æŒ‡å—](../../CONTRIBUTING.md) äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

## ğŸ“„ è®¸å¯è¯

[MIT](../../LICENSE) Â© LDesign Team

## ğŸ”— ç›¸å…³é“¾æ¥

- [æ–‡æ¡£](./docs/index.md)
- [API å‚è€ƒ](./docs/api/index.md)
- [ç¤ºä¾‹](./examples/)
- [æ›´æ–°æ—¥å¿—](./CHANGELOG.md)

## ç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½** - ä¼˜åŒ–çš„æ€§èƒ½è¡¨ç°
- ğŸ¯ **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ TypeScript æ”¯æŒ
- ğŸ“¦ **è½»é‡çº§** - æœ€å°åŒ–çš„åŒ…ä½“ç§¯
- ğŸ”§ **æ˜“äºä½¿ç”¨** - ç®€æ´çš„ API è®¾è®¡

## å®‰è£…

```bash
npm install @ldesign/api
# æˆ–
pnpm add @ldesign/api
# æˆ–
yarn add @ldesign/api
```

## ä½¿ç”¨

### å¿«é€Ÿä¸Šæ‰‹ï¼šä¸­é—´ä»¶/é‡è¯•/è®¤è¯/è½®è¯¢/ç±»å‹å¢å¼ºï¼ˆæ–°å¢ï¼‰

```ts
import { createApiEngine, authMiddlewaresPlugin, systemApiPlugin, withTypedApi } from '@ldesign/api'

const api = createApiEngine({
  retry: { enabled: true, retries: 2, delay: 200 },
  middlewares: {
    request: [(cfg) => { cfg.headers = { ...(cfg.headers||{}), 'X-App':'ldesign' }; return cfg }],
    response: [(res) => { if (res.data?.data) res.data = res.data.data; return res }],
  }
})

await api.use(authMiddlewaresPlugin)
await api.use(systemApiPlugin)

// å¯é€‰ï¼šç±»å‹å¢å¼ºï¼ˆä»…ç±»å‹å±‚ï¼Œè¿è¡Œæ—¶é›¶æˆæœ¬ï¼‰
type Registry = { getUserInfo: { id: string, username: string } }
const typed = withTypedApi<Registry>(api)
const u = await typed.call('getUserInfo')
```

æ›´å¤šè§ docs/guide/middlewares.md ä¸ docs/guide/rest.mdã€‚

### åŸºç¡€ç”¨æ³•

```typescript
import { api } from '@ldesign/api'

api()
```

## API æ–‡æ¡£

è¯¦ç»†çš„ API æ–‡æ¡£è¯·è®¿é—®ï¼š[æ–‡æ¡£ç«™ç‚¹](https://ldesign.github.io/api/)

## å¼€å‘

```bash
# å®‰è£…ä¾èµ–
pnpm install

# å¼€å‘æ¨¡å¼
pnpm dev

# æ„å»º
pnpm build

# æµ‹è¯•
pnpm test

# E2E æµ‹è¯•
pnpm test:e2e

# æ–‡æ¡£å¼€å‘
pnpm docs:dev
```

## è®¸å¯è¯

MIT Â© LDesign Team
