{"version":3,"file":"transformer.js","sources":["../../../../../http/es/utils/transformer.js"],"sourcesContent":["class t{constructor(r={}){this.config={transformDates:r.transformDates??!0,transformBigInt:r.transformBigInt??!1,nullToUndefined:r.nullToUndefined??!1,emptyStringToNull:r.emptyStringToNull??!1,datePattern:r.datePattern??t.ISO_DATE_REGEX,customTransformers:r.customTransformers??[]}}transform(t){return this.transformValue(\"root\",t)}transformValue(t,r){for(const n of this.config?.customTransformers||[]){const e=n(t,r);if(void 0!==e)return e}return null===r?this.config?.nullToUndefined?void 0:null:void 0!==r?\"string\"==typeof r?this.transformString(t,r):Array.isArray(r)?r.map((r,n)=>this.transformValue(`${t}[${n}]`,r)):\"object\"==typeof r&&null!==r?this.transformObject(r):r:void 0}transformString(t,r){if(\"\"===r&&this.config?.emptyStringToNull)return null;if(this.config?.transformDates&&this.isDateField(t,r)){const t=new Date(r);if(!Number.isNaN(t.getTime()))return t}if(this.config?.transformBigInt&&this.isBigIntString(r))try{return BigInt(r)}catch{}return r}transformObject(t){const r={};for(const[n,e]of Object.entries(t))r[n]=this.transformValue(n,e);return r}isDateField(r,n){const e=r.toLowerCase(),s=t.DATE_FIELD_NAMES.some(t=>e.includes(t.toLowerCase())),a=this.config?.datePattern.test(n);return s||a}isBigIntString(t){if(!/^\\d+$/.test(t))return!1;const r=Number(t);return r>Number.MAX_SAFE_INTEGER||r<Number.MIN_SAFE_INTEGER}serialize(t){return this.serializeValue(t)}serializeValue(t){if(t instanceof Date)return t.toISOString();if(\"bigint\"==typeof t)return t.toString();if(Array.isArray(t))return t.map(t=>this.serializeValue(t));if(\"object\"==typeof t&&null!==t){const r={};for(const[n,e]of Object.entries(t))r[n]=this.serializeValue(e);return r}return t}}function r(r){return new t(r)}t.ISO_DATE_REGEX=/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?$/,t.DATE_FIELD_NAMES=[\"date\",\"time\",\"createdAt\",\"updatedAt\",\"deletedAt\",\"publishedAt\",\"timestamp\",\"startTime\",\"endTime\"];const n=new t;function e(r){const n=new t(r);return{request:{onFulfilled:t=>(t.data&&(t.data=n.serialize(t.data)),t)},response:{onFulfilled:t=>(t.data&&(t.data=n.transform(t.data)),t)}}}function s(r){return new t({transformDates:!0,transformBigInt:!1}).transform(r)}function a(r){return new t({transformDates:!1,transformBigInt:!0}).transform(r)}function i(r){return new t({transformDates:!1,nullToUndefined:!0}).transform(r)}export{t as DataTransformer,e as createDataTransformInterceptor,r as createDataTransformer,n as globalDataTransformer,i as nullToUndefined,a as transformBigInts,s as transformDates};\n//# sourceMappingURL=transformer.js.map\n"],"names":["r","t","n","e","s","a"],"mappings":"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"}