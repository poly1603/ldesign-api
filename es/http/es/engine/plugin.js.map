{"version":3,"file":"plugin.js","sources":["../../../../../http/es/engine/plugin.js"],"sourcesContent":["import{createAdapter as e}from\"../adapters/index.js\";import{HttpClientImpl as t}from\"../client.js\";import{HttpPlugin as n}from\"../vue/plugin.js\";function o(o={}){const{name:i=\"http\",version:l=\"1.0.0\",clientConfig:r={},globalPropertyName:a=\"$http\",client:p,globalConfig:g,...c}=o;return{name:i,version:l,dependencies:[],async install(o){try{if(o&&\"object\"==typeof o.config&&\"function\"==typeof o.provide){const n=o;await(async()=>{const o=p||(()=>{const n=e(r.adapter);return new t({...r,...g},n)})(),i={get:(e,t)=>o.get(e,t),post:(e,t,n)=>o.post(e,t,n),put:(e,t,n)=>o.put(e,t,n),delete:(e,t)=>o.delete(e,t),patch:(e,t,n)=>o.patch(e,t,n),head:(e,t)=>o.head(e,t),options:(e,t)=>o.options(e,t),upload:(e,t,n)=>o.upload?o.upload(e,t,n):o.post(e,t,n),download:(e,t)=>o.download?o.download(e,t):o.get(e,t)};try{n.config&&n.config.globalProperties&&(n.config.globalProperties.$http=i,n.config.globalProperties.$httpClient=o)}catch(e){}try{\"function\"==typeof n.provide&&(n.provide(\"http\",i),n.provide(\"httpClient\",o))}catch(e){}})()}else{const s=o.engine||o;if(!s||\"function\"!=typeof s.getApp)return;const u=async()=>{const o=s.getApp();if(!o)throw new Error(\"Vue app not found. Make sure the engine has created a Vue app before installing HTTP plugin.\");const u=p||(()=>{const n=e(r.adapter);return new t({...r,...g},n)})();o.use(n,{client:u,globalConfig:g||r,globalProperty:a,...c}),s.http?s.http.setInstance(u):s.httpClient=u,s.logger&&s.logger.info(`${i} plugin installed successfully`,{version:l,clientType:u.constructor.name})};s.getApp()?(s.logger&&s.logger.info(\"[HTTP Plugin] Vue app found, installing immediately\"),await u()):(s.logger&&s.logger.info(\"[HTTP Plugin] Vue app not found, registering event listener\"),await new Promise((e,t)=>{s.events.once(\"app:created\",async()=>{try{s.logger&&s.logger.info(\"[HTTP Plugin] app:created event received, installing now\"),await u(),e()}catch(e){s.logger&&s.logger.error(\"[HTTP Plugin] Failed to install after app creation:\",e),t(e)}})})),s.logger&&s.logger.info(`${i} plugin registered, waiting for Vue app creation...`)}}catch(e){throw e}},async uninstall(e){try{const t=e.engine||e;if(!t)throw new Error(\"Invalid engine context\");if(t.httpClient){const e=t.httpClient;e.cancelAll(),e.clearCache(),delete t.httpClient}t.logger.info(`${i} plugin uninstalled successfully`)}catch(t){const n=e.engine||e;throw n&&n.logger&&n.logger.error(`Failed to uninstall ${i} plugin:`,t),t}}}}function i(e){return o(e)}const l=o({globalInjection:!0,globalPropertyName:\"$http\",clientConfig:{timeout:1e4,headers:{\"Content-Type\":\"application/json\"}}});function r(e){return o(e||{})}export{o as createHttpEnginePlugin,r as createHttpPlugin,l as defaultHttpEnginePlugin,i as httpPlugin};\n//# sourceMappingURL=plugin.js.map\n"],"names":["o","i","l","r","n","e","t","s","u"],"mappings":";;;;;;;;;;;;;AAAiJ,SAAS,CAAA,CAAEA,EAAAA,GAAE,EAAC,EAAE;AAAC,EAAA,MAAK,EAAC,MAAKC,EAAAA,GAAE,MAAA,EAAO,SAAQC,EAAAA,GAAE,OAAA,EAAQ,cAAaC,EAAAA,GAAE,IAAG,kBAAA,EAAmB,CAAA,GAAE,SAAQ,MAAA,EAAO,CAAA,EAAE,cAAa,CAAA,EAAE,GAAG,GAAC,GAAEH,EAAAA;AAAE,EAAA,OAAM,EAAC,IAAA,EAAKC,EAAAA,EAAE,OAAA,EAAQC,EAAAA,EAAE,cAAa,EAAC,EAAE,MAAM,OAAA,CAAQF,EAAAA,EAAE;AAAC,IAAA,IAAG;AAAC,MAAA,IAAGA,EAAAA,IAAG,YAAU,OAAOA,EAAAA,CAAE,UAAQ,UAAA,IAAY,OAAOA,GAAE,OAAA,EAAQ;AAAC,QAAA,MAAMI,EAAAA,GAAEJ,EAAAA;AAAE,QAAA,MAAA,CAAM,YAAS;AAAC,UAAA,MAAMA,EAAAA,GAAE,MAAI,MAAI;AAAC,YAAA,MAAMI,EAAAA,GAAEC,CAAA,CAAEF,EAAAA,CAAE,OAAO,CAAA;AAAE,YAAA,OAAO,IAAIG,EAAE,EAAC,GAAGH,IAAE,GAAG,CAAA,IAAGC,EAAC,CAAA;AAAA,UAAC,CAAA,KAAKH,EAAAA,GAAE,EAAC,KAAI,CAACI,EAAAA,EAAEC,EAAAA,KAAIN,EAAAA,CAAE,GAAA,CAAIK,EAAAA,EAAEC,EAAC,CAAA,EAAE,IAAA,EAAK,CAACD,EAAAA,EAAEC,EAAAA,EAAEF,EAAAA,KAAIJ,GAAE,IAAA,CAAKK,EAAAA,EAAEC,EAAAA,EAAEF,EAAC,CAAA,EAAE,GAAA,EAAI,CAACC,EAAAA,EAAEC,EAAAA,EAAEF,EAAAA,KAAIJ,EAAAA,CAAE,GAAA,CAAIK,EAAAA,EAAEC,IAAEF,EAAC,CAAA,EAAE,MAAA,EAAO,CAACC,EAAAA,EAAEC,EAAAA,KAAIN,GAAE,MAAA,CAAOK,EAAAA,EAAEC,EAAC,CAAA,EAAE,KAAA,EAAM,CAACD,IAAEC,EAAAA,EAAEF,EAAAA,KAAIJ,EAAAA,CAAE,KAAA,CAAMK,EAAAA,EAAEC,EAAAA,EAAEF,EAAC,CAAA,EAAE,IAAA,EAAK,CAACC,EAAAA,EAAEC,EAAAA,KAAIN,EAAAA,CAAE,KAAKK,EAAAA,EAAEC,EAAC,CAAA,EAAE,OAAA,EAAQ,CAACD,EAAAA,EAAEC,OAAIN,EAAAA,CAAE,OAAA,CAAQK,EAAAA,EAAEC,EAAC,CAAA,EAAE,MAAA,EAAO,CAACD,EAAAA,EAAEC,EAAAA,EAAEF,EAAAA,KAAIJ,EAAAA,CAAE,MAAA,GAAOA,EAAAA,CAAE,OAAOK,EAAAA,EAAEC,EAAAA,EAAEF,EAAC,CAAA,GAAEJ,EAAAA,CAAE,IAAA,CAAKK,IAAEC,EAAAA,EAAEF,EAAC,CAAA,EAAE,QAAA,EAAS,CAACC,EAAAA,EAAEC,OAAIN,EAAAA,CAAE,QAAA,GAASA,EAAAA,CAAE,QAAA,CAASK,EAAAA,EAAEC,EAAC,IAAEN,EAAAA,CAAE,GAAA,CAAIK,EAAAA,EAAEC,EAAC,CAAA,EAAC;AAAE,UAAA,IAAG;AAAC,YAAAF,EAAAA,CAAE,MAAA,IAAQA,EAAAA,CAAE,MAAA,CAAO,gBAAA,KAAmBA,EAAAA,CAAE,MAAA,CAAO,gBAAA,CAAiB,KAAA,GAAMH,EAAAA,EAAEG,EAAAA,CAAE,MAAA,CAAO,iBAAiB,WAAA,GAAYJ,EAAAA,CAAAA;AAAA,UAAE,SAAOK,EAAAA,EAAE;AAAA,UAAC;AAAC,UAAA,IAAG;AAAC,YAAA,UAAA,IAAY,OAAOD,EAAAA,CAAE,OAAA,KAAUA,EAAAA,CAAE,OAAA,CAAQ,MAAA,EAAOH,EAAC,CAAA,EAAEG,EAAAA,CAAE,OAAA,CAAQ,YAAA,EAAaJ,EAAC,CAAA,CAAA;AAAA,UAAE,SAAOK,EAAAA,EAAE;AAAA,UAAC;AAAA,QAAC,CAAA,GAAG;AAAA,MAAC,CAAA,MAAK;AAAC,QAAA,MAAME,GAAA,GAAEP,GAAE,MAAA,IAAQA,EAAAA;AAAE,QAAA,IAAG,CAACO,GAAA,IAAG,UAAA,IAAY,OAAOA,IAAE,MAAA,EAAO;AAAO,QAAA,MAAM,IAAE,YAAS;AAAC,UAAA,MAAMP,EAAAA,GAAEO,IAAE,MAAA,EAAO;AAAE,UAAA,IAAG,CAACP,EAAAA,EAAE,MAAM,IAAI,MAAM,8FAA8F,CAAA;AAAE,UAAA,MAAMQ,EAAAA,GAAE,MAAI,MAAI;AAAC,YAAA,MAAMJ,EAAAA,GAAEC,CAAA,CAAEF,EAAAA,CAAE,OAAO,CAAA;AAAE,YAAA,OAAO,IAAIG,EAAE,EAAC,GAAGH,IAAE,GAAG,CAAA,IAAGC,EAAC,CAAA;AAAA,UAAC,CAAA,GAAG;AAAE,UAAAJ,GAAE,GAAA,CAAII,GAAA,EAAE,EAAC,MAAA,EAAOI,EAAAA,EAAE,cAAa,CAAA,IAAGL,EAAAA,EAAE,cAAA,EAAe,CAAA,EAAE,GAAG,CAAA,EAAE,GAAEI,GAAA,CAAE,IAAA,GAAKA,IAAE,IAAA,CAAK,WAAA,CAAYC,EAAC,CAAA,GAAED,IAAE,UAAA,GAAWC,EAAAA,EAAED,IAAE,MAAA,IAAQA,GAAA,CAAE,OAAO,IAAA,CAAK,CAAA,EAAGN,EAAC,CAAA,8BAAA,CAAA,EAAiC,EAAC,OAAA,EAAQC,EAAAA,EAAE,YAAWM,EAAAA,CAAE,WAAA,CAAY,MAAK,CAAA;AAAA,QAAC,CAAA;AAAE,QAAAD,GAAA,CAAE,MAAA,EAAO,IAAGA,GAAA,CAAE,MAAA,IAAQA,GAAA,CAAE,OAAO,IAAA,CAAK,qDAAqD,CAAA,EAAE,MAAM,CAAA,EAAE,KAAIA,IAAE,MAAA,IAAQA,GAAA,CAAE,MAAA,CAAO,IAAA,CAAK,6DAA6D,CAAA,EAAE,MAAM,IAAI,OAAA,CAAQ,CAACF,EAAAA,EAAEC,EAAAA,KAAI;AAAC,UAAAC,GAAA,CAAE,MAAA,CAAO,IAAA,CAAK,aAAA,EAAc,YAAS;AAAC,YAAA,IAAG;AAAC,cAAAA,GAAA,CAAE,MAAA,IAAQA,IAAE,MAAA,CAAO,IAAA,CAAK,0DAA0D,CAAA,EAAE,MAAM,CAAA,EAAE,EAAEF,EAAAA,EAAE;AAAA,YAAC,SAAOA,EAAAA,EAAE;AAAC,cAAAE,GAAA,CAAE,MAAA,IAAQA,IAAE,MAAA,CAAO,KAAA,CAAM,uDAAsDF,EAAC,CAAA,EAAEC,GAAED,EAAC,CAAA;AAAA,YAAC;AAAA,UAAC,CAAC,CAAA;AAAA,QAAC,CAAC,IAAGE,GAAA,CAAE,MAAA,IAAQA,IAAE,MAAA,CAAO,IAAA,CAAK,CAAA,EAAGN,EAAC,CAAA,mDAAA,CAAqD,CAAA;AAAA,MAAC;AAAA,IAAC,SAAOI,EAAAA,EAAE;AAAC,MAAA,MAAMA,EAAAA;AAAA,IAAC;AAAA,EAAC,CAAA,EAAE,MAAM,SAAA,CAAUA,EAAAA,EAAE;AAAC,IAAA,IAAG;AAAC,MAAA,MAAMC,EAAAA,GAAED,GAAE,MAAA,IAAQA,EAAAA;AAAE,MAAA,IAAG,CAACC,EAAAA,EAAE,MAAM,IAAI,MAAM,wBAAwB,CAAA;AAAE,MAAA,IAAGA,GAAE,UAAA,EAAW;AAAC,QAAA,MAAMD,KAAEC,EAAAA,CAAE,UAAA;AAAW,QAAAD,GAAE,SAAA,EAAU,EAAEA,GAAE,UAAA,EAAW,EAAE,OAAOC,EAAAA,CAAE,UAAA;AAAA,MAAU;AAAC,MAAAA,EAAAA,CAAE,MAAA,CAAO,IAAA,CAAK,CAAA,EAAGL,EAAC,CAAA,gCAAA,CAAkC,CAAA;AAAA,IAAC,SAAOK,EAAAA,EAAE;AAAC,MAAA,MAAMF,EAAAA,GAAEC,GAAE,MAAA,IAAQA,EAAAA;AAAE,MAAA,MAAMD,EAAAA,IAAGA,EAAAA,CAAE,MAAA,IAAQA,EAAAA,CAAE,MAAA,CAAO,MAAM,CAAA,oBAAA,EAAuBH,EAAC,CAAA,QAAA,CAAA,EAAWK,EAAC,CAAA,EAAEA,EAAAA;AAAA,IAAC;AAAA,EAAC,CAAA,EAAC;AAAC;AAAmC,CAAA,CAAE,EAAC,eAAA,EAAgB,IAAA,EAAG,oBAAmB,OAAA,EAAQ,YAAA,EAAa,EAAC,OAAA,EAAQ,KAAI,OAAA,EAAQ,EAAC,gBAAe,kBAAA,EAAkB,IAAG;;;;;;;"}